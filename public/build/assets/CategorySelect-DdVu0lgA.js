import{aw as B,c as g,r as m,e as D,f as q,h as l,X as F,w as t,s as R,W as j,p as c,v as E,k as M,q as O,V as r,m as y,a4 as P,af as K,ae as W,a9 as X,T as _,n as w,aa as z,a2 as G}from"./app-BU2Ar5cD.js";import{u as H}from"./useToast-CtmKKjnB.js";import{A as I}from"./AddNewSelect-DGVIgTqL.js";const Y=Object.assign({inheritAttrs:!1},{__name:"CategorySelect",props:{modelValue:{type:[String,Number,Array,Object,Boolean,null],default:null},items:{type:Array,default:()=>[]},label:{type:String,default:"Category"},addNewText:{type:String,default:"Add New Category"},control:{type:String,default:"select"},showAddNew:{type:Boolean,default:!0}},emits:["update:modelValue","created"],setup(u,{emit:C}){const b=u,V=C,x=B(),A=g(()=>{const{"onUpdate:modelValue":d,"onUpdate:model-value":e,...a}=x;return a}),{success:N,handleError:U}=H(),s=m(!1),f=m(!1),n=m(null),o=m({name:"",code:"",parent_id:null,description:"",is_active:!0}),S=g(()=>b.items.filter(d=>!d.parent_id)),T=()=>{s.value=!0},v=()=>{var d;s.value=!1,o.value={name:"",code:"",parent_id:null,description:"",is_active:!0},(d=n.value)!=null&&d.resetValidation&&n.value.resetValidation()},k=async()=>{var e,a;const d=await((e=n.value)==null?void 0:e.validate());if(!(d===!1||(d==null?void 0:d.valid)===!1)){f.value=!0;try{const i=await G.post("/api/categories",o.value),p=((a=i.data)==null?void 0:a.category)||i.data;N("Category created successfully"),V("created",p),V("update:modelValue",p.id),v()}catch(i){U(i,"Failed to create category")}finally{f.value=!1}}};return(d,e)=>(q(),D("div",null,[l(I,F(A.value,{"model-value":u.modelValue,items:u.items,label:u.label,"add-new-text":u.addNewText,control:u.control,"show-add-new":u.showAddNew,"onUpdate:modelValue":e[0]||(e[0]=a=>V("update:modelValue",a)),onAddNew:T}),null,16,["model-value","items","label","add-new-text","control","show-add-new"]),l(z,{modelValue:s.value,"onUpdate:modelValue":e[6]||(e[6]=a=>s.value=a),"max-width":"600px",persistent:""},{default:t(()=>[l(R,null,{default:t(()=>[l(j,null,{default:t(()=>[...e[7]||(e[7]=[c("New Category",-1)])]),_:1}),l(E,null,{default:t(()=>[l(M,{ref_key:"form",ref:n},{default:t(()=>[l(O,null,{default:t(()=>[l(r,{cols:"12",md:"6"},{default:t(()=>[l(y,{modelValue:o.value.name,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.name=a),label:"Category Name *",variant:"outlined",rules:[a=>!!a||"Required"]},null,8,["modelValue","rules"])]),_:1}),l(r,{cols:"12",md:"6"},{default:t(()=>[l(y,{modelValue:o.value.code,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.code=a),label:"Category Code *",variant:"outlined",rules:[a=>!!a||"Required"]},null,8,["modelValue","rules"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(P,{modelValue:o.value.parent_id,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.parent_id=a),items:S.value,"item-title":"name","item-value":"id",label:"Parent Category",variant:"outlined",clearable:""},null,8,["modelValue","items"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(K,{modelValue:o.value.description,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.description=a),label:"Description",variant:"outlined",rows:"2"},null,8,["modelValue"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(W,{modelValue:o.value.is_active,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.is_active=a),label:"Active",color:"primary"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(X,null,{default:t(()=>[l(_),l(w,{onClick:v},{default:t(()=>[...e[8]||(e[8]=[c("Cancel",-1)])]),_:1}),l(w,{color:"primary",loading:f.value,onClick:k},{default:t(()=>[...e[9]||(e[9]=[c("Save",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}});export{Y as _};
