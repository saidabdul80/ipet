import{aw as h,c as D,r as u,e as F,f as j,h as l,X as E,w as t,s as M,W as O,p,v as _,k as K,q as P,V as r,m as g,a4 as S,af as W,ae as X,a9 as z,T as G,n as x,aa as H,a2 as A}from"./app-CJq9zEpr.js";import{u as I}from"./useToast-DKMsU9PD.js";import{A as J}from"./AddNewSelect-Cy-bT142.js";const Z=Object.assign({inheritAttrs:!1},{__name:"StoreSelect",props:{modelValue:{type:[String,Number,Array,Object,Boolean,null],default:null},items:{type:Array,default:()=>[]},label:{type:String,default:"Store"},addNewText:{type:String,default:"Add New Store"},control:{type:String,default:"select"},showAddNew:{type:Boolean,default:!0}},emits:["update:modelValue","created"],setup(s,{emit:N}){const v=N,U=h(),T=D(()=>{const{"onUpdate:modelValue":d,"onUpdate:model-value":a,...e}=U;return e}),{success:C,handleError:w}=I(),n=u(!1),f=u(!1),i=u(null),V=u([]),c=u(!1),B=["warehouse","retail","showroom"],o=u({name:"",code:"",branch_id:null,type:null,address:"",is_active:!0}),k=async()=>{n.value=!0,V.value.length||await q()},y=()=>{var d;n.value=!1,o.value={name:"",code:"",branch_id:null,type:null,address:"",is_active:!0},(d=i.value)!=null&&d.resetValidation&&i.value.resetValidation()},q=async()=>{c.value=!0;try{const d=await A.get("/api/branches",{params:{per_page:1e3}});V.value=d.data.data||d.data}catch(d){w(d,"Failed to load branches")}finally{c.value=!1}},R=async()=>{var a,e;const d=await((a=i.value)==null?void 0:a.validate());if(!(d===!1||(d==null?void 0:d.valid)===!1)){f.value=!0;try{const m=await A.post("/api/stores",o.value),b=((e=m.data)==null?void 0:e.store)||m.data;C("Store created successfully"),v("created",b),v("update:modelValue",b.id),y()}catch(m){w(m,"Failed to create store")}finally{f.value=!1}}};return(d,a)=>(j(),F("div",null,[l(J,E(T.value,{"model-value":s.modelValue,items:s.items,label:s.label,"add-new-text":s.addNewText,control:s.control,"show-add-new":s.showAddNew,"onUpdate:modelValue":a[0]||(a[0]=e=>v("update:modelValue",e)),onAddNew:k}),null,16,["model-value","items","label","add-new-text","control","show-add-new"]),l(H,{modelValue:n.value,"onUpdate:modelValue":a[7]||(a[7]=e=>n.value=e),"max-width":"700px",persistent:""},{default:t(()=>[l(M,null,{default:t(()=>[l(O,null,{default:t(()=>[...a[8]||(a[8]=[p("New Store",-1)])]),_:1}),l(_,null,{default:t(()=>[l(K,{ref_key:"form",ref:i},{default:t(()=>[l(P,null,{default:t(()=>[l(r,{cols:"12",md:"6"},{default:t(()=>[l(g,{modelValue:o.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>o.value.name=e),label:"Store Name *",variant:"outlined",rules:[e=>!!e||"Required"]},null,8,["modelValue","rules"])]),_:1}),l(r,{cols:"12",md:"6"},{default:t(()=>[l(g,{modelValue:o.value.code,"onUpdate:modelValue":a[2]||(a[2]=e=>o.value.code=e),label:"Store Code *",variant:"outlined",rules:[e=>!!e||"Required"]},null,8,["modelValue","rules"])]),_:1}),l(r,{cols:"12",md:"6"},{default:t(()=>[l(S,{modelValue:o.value.branch_id,"onUpdate:modelValue":a[3]||(a[3]=e=>o.value.branch_id=e),items:V.value,"item-title":"name","item-value":"id",label:"Branch *",variant:"outlined",rules:[e=>!!e||"Required"],loading:c.value},null,8,["modelValue","items","rules","loading"])]),_:1}),l(r,{cols:"12",md:"6"},{default:t(()=>[l(S,{modelValue:o.value.type,"onUpdate:modelValue":a[4]||(a[4]=e=>o.value.type=e),items:B,label:"Store Type *",variant:"outlined",rules:[e=>!!e||"Required"]},null,8,["modelValue","rules"])]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(W,{modelValue:o.value.address,"onUpdate:modelValue":a[5]||(a[5]=e=>o.value.address=e),label:"Address",variant:"outlined",rows:"2"},null,8,["modelValue"])]),_:1}),l(r,{cols:"12",md:"6"},{default:t(()=>[l(X,{modelValue:o.value.is_active,"onUpdate:modelValue":a[6]||(a[6]=e=>o.value.is_active=e),label:"Active",color:"primary"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(z,null,{default:t(()=>[l(G),l(x,{onClick:y},{default:t(()=>[...a[9]||(a[9]=[p("Cancel",-1)])]),_:1}),l(x,{color:"primary",loading:f.value,onClick:R},{default:t(()=>[...a[10]||(a[10]=[p("Save",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}});export{Z as _};
