import{b as O,ac as Q,r as m,o as X,e as Y,f,h as l,w as a,V as u,i as r,q as b,m as p,g as y,j as c,E as U,n as v,p as s,G as x,ad as Z,P as $,t as d,s as D,W as E,v as I,k as h,af as q,ae as ee,a9 as z,T as R,aa as M,a2 as C}from"./app-CJq9zEpr.js";const le={class:"font-weight-bold"},ae={class:"text-caption text-grey"},ue={__name:"SupplierList",setup(te){const S=O(),{alert:N,confirm:j}=Q(),w=m(!1),A=m(!1),V=m(!1),_=m(!1),k=m(!1),P=m(""),T=m([]),n=m(null),G=[{title:"Supplier",key:"name"},{title:"Phone",key:"phone"},{title:"Contact Person",key:"contact_person"},{title:"Payment Terms",key:"payment_terms_days"},{title:"Status",key:"is_active"},{title:"Actions",key:"actions",sortable:!1}],o=m({name:"",email:"",phone:"",contact_person:"",address:"",tax_id:"",bank_account:"",payment_terms_days:30,is_active:!0,notes:""}),g=async()=>{w.value=!0;try{const i={search:P.value},e=await C.get("/api/suppliers",{params:i});T.value=e.data.data||e.data}catch(i){console.error("Failed to load suppliers:",i)}finally{w.value=!1}},L=()=>{k.value=!1,o.value={name:"",email:"",phone:"",contact_person:"",address:"",tax_id:"",bank_account:"",payment_terms_days:30,is_active:!0,notes:""},V.value=!0},W=i=>{k.value=!0,o.value={...i},V.value=!0},B=()=>{V.value=!1},H=async()=>{A.value=!0;try{k.value?await C.put(`/api/suppliers/${o.value.id}`,o.value):await C.post("/api/suppliers",o.value),B(),g()}catch(i){console.error("Failed to save supplier:",i),N("Failed to save supplier")}finally{A.value=!1}},J=i=>{n.value=i,_.value=!0},K=async i=>{if(await j(`Are you sure you want to delete ${i.name}?`))try{await C.delete(`/api/suppliers/${i.id}`),g()}catch(t){console.error("Failed to delete supplier:",t),N("Failed to delete supplier")}};return X(()=>{g()}),(i,e)=>(f(),Y("div",null,[l(b,null,{default:a(()=>[l(u,{cols:"12"},{default:a(()=>[...e[14]||(e[14]=[r("h1",{class:"text-h4 mb-4"},"Suppliers",-1)])]),_:1})]),_:1}),l(b,null,{default:a(()=>[l(u,{cols:"12",md:"8"},{default:a(()=>[l(p,{modelValue:P.value,"onUpdate:modelValue":e[0]||(e[0]=t=>P.value=t),label:"Search suppliers...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",onInput:g},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"4",class:"text-right"},{default:a(()=>[U(S).hasPermission("create_suppliers")?(f(),y(v,{key:0,color:"primary",onClick:L},{default:a(()=>[l(x,{left:""},{default:a(()=>[...e[15]||(e[15]=[s("mdi-plus",-1)])]),_:1}),e[16]||(e[16]=s(" Add Supplier ",-1))]),_:1})):c("",!0)]),_:1})]),_:1}),l(D,null,{default:a(()=>[l(Z,{headers:G,items:T.value,loading:w.value},{"item.name":a(({item:t})=>[r("div",null,[r("div",le,d(t.name),1),r("div",ae,d(t.email),1)])]),"item.is_active":a(({item:t})=>[l($,{color:t.is_active?"success":"error",size:"small"},{default:a(()=>[s(d(t.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),"item.actions":a(({item:t})=>[l(v,{icon:"",size:"small",onClick:F=>J(t),title:"View"},{default:a(()=>[l(x,null,{default:a(()=>[...e[17]||(e[17]=[s("mdi-eye",-1)])]),_:1})]),_:1},8,["onClick"]),U(S).hasPermission("edit_suppliers")?(f(),y(v,{key:0,icon:"",size:"small",onClick:F=>W(t),title:"Edit"},{default:a(()=>[l(x,null,{default:a(()=>[...e[18]||(e[18]=[s("mdi-pencil",-1)])]),_:1})]),_:1},8,["onClick"])):c("",!0),U(S).hasPermission("delete_suppliers")?(f(),y(v,{key:1,icon:"",size:"small",onClick:F=>K(t),title:"Delete",color:"error"},{default:a(()=>[l(x,null,{default:a(()=>[...e[19]||(e[19]=[s("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])):c("",!0)]),_:1},8,["items","loading"])]),_:1}),l(M,{modelValue:V.value,"onUpdate:modelValue":e[11]||(e[11]=t=>V.value=t),"max-width":"700px",persistent:""},{default:a(()=>[l(D,null,{default:a(()=>[l(E,null,{default:a(()=>[s(d(k.value?"Edit Supplier":"New Supplier"),1)]),_:1}),l(I,null,{default:a(()=>[l(h,{ref:"form"},{default:a(()=>[l(b,null,{default:a(()=>[l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:o.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.name=t),label:"Supplier Name *",variant:"outlined",rules:[t=>!!t||"Required"]},null,8,["modelValue","rules"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:o.value.email,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.email=t),label:"Email *",type:"email",variant:"outlined",rules:[t=>!!t||"Required"]},null,8,["modelValue","rules"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:o.value.phone,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.phone=t),label:"Phone *",variant:"outlined",rules:[t=>!!t||"Required"]},null,8,["modelValue","rules"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:o.value.contact_person,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.contact_person=t),label:"Contact Person",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12"},{default:a(()=>[l(q,{modelValue:o.value.address,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.address=t),label:"Address",variant:"outlined",rows:"2"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:o.value.tax_id,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.tax_id=t),label:"Tax ID",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:o.value.bank_account,"onUpdate:modelValue":e[7]||(e[7]=t=>o.value.bank_account=t),label:"Bank Account",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:o.value.payment_terms_days,"onUpdate:modelValue":e[8]||(e[8]=t=>o.value.payment_terms_days=t),modelModifiers:{number:!0},label:"Payment Terms (Days)",type:"number",min:"0",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(ee,{modelValue:o.value.is_active,"onUpdate:modelValue":e[9]||(e[9]=t=>o.value.is_active=t),label:"Active",color:"primary"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12"},{default:a(()=>[l(q,{modelValue:o.value.notes,"onUpdate:modelValue":e[10]||(e[10]=t=>o.value.notes=t),label:"Notes",variant:"outlined",rows:"2"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(z,null,{default:a(()=>[l(R),l(v,{onClick:B},{default:a(()=>[...e[20]||(e[20]=[s("Cancel",-1)])]),_:1}),l(v,{color:"primary",onClick:H,loading:A.value},{default:a(()=>[...e[21]||(e[21]=[s("Save",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(M,{modelValue:_.value,"onUpdate:modelValue":e[13]||(e[13]=t=>_.value=t),"max-width":"700px"},{default:a(()=>[n.value?(f(),y(D,{key:0},{default:a(()=>[l(E,{class:"bg-primary text-white"},{default:a(()=>[s(d(n.value.name)+" ",1),l($,{color:n.value.is_active?"success":"error",class:"ml-2"},{default:a(()=>[s(d(n.value.is_active?"Active":"Inactive"),1)]),_:1},8,["color"])]),_:1}),l(I,{class:"mt-4"},{default:a(()=>[l(b,null,{default:a(()=>[l(u,{cols:"6"},{default:a(()=>[e[22]||(e[22]=r("strong",null,"Email:",-1)),s(" "+d(n.value.email),1)]),_:1}),l(u,{cols:"6"},{default:a(()=>[e[23]||(e[23]=r("strong",null,"Phone:",-1)),s(" "+d(n.value.phone),1)]),_:1}),l(u,{cols:"6"},{default:a(()=>[e[24]||(e[24]=r("strong",null,"Contact Person:",-1)),s(" "+d(n.value.contact_person||"N/A"),1)]),_:1}),l(u,{cols:"6"},{default:a(()=>[e[25]||(e[25]=r("strong",null,"Payment Terms:",-1)),s(" "+d(n.value.payment_terms_days||0)+" days ",1)]),_:1}),l(u,{cols:"12"},{default:a(()=>[e[26]||(e[26]=r("strong",null,"Address:",-1)),s(" "+d(n.value.address||"N/A"),1)]),_:1}),l(u,{cols:"6"},{default:a(()=>[e[27]||(e[27]=r("strong",null,"Tax ID:",-1)),s(" "+d(n.value.tax_id||"N/A"),1)]),_:1}),l(u,{cols:"6"},{default:a(()=>[e[28]||(e[28]=r("strong",null,"Bank Account:",-1)),s(" "+d(n.value.bank_account||"N/A"),1)]),_:1}),n.value.notes?(f(),y(u,{key:0,cols:"12"},{default:a(()=>[e[29]||(e[29]=r("strong",null,"Notes:",-1)),r("p",null,d(n.value.notes),1)]),_:1})):c("",!0)]),_:1})]),_:1}),l(z,null,{default:a(()=>[l(R),l(v,{onClick:e[12]||(e[12]=t=>_.value=!1)},{default:a(()=>[...e[30]||(e[30]=[s("Close",-1)])]),_:1})]),_:1})]),_:1})):c("",!0)]),_:1},8,["modelValue"])]))}};export{ue as default};
