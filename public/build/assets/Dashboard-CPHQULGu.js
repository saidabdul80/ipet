import{b as L,r as f,o as E,a2 as k,a3 as G,e as H,f as g,h as t,w as l,V as i,i as s,F as M,G as r,p as d,P as A,t as u,q as c,g as z,j as T,a4 as B,E as I,n as N,s as v,W as O,H as U,v as W,a5 as R,a6 as q}from"./app-CJq9zEpr.js";import{_ as Y}from"./StoreSelect-CUGTwINW.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useToast-DKMsU9PD.js";import"./AddNewSelect-Cy-bT142.js";const J={class:"d-flex align-center"},K={class:"d-flex justify-space-between align-center"},Q={class:"text-h5 font-weight-bold"},X={class:"d-flex justify-space-between align-center"},Z={class:"text-h5 font-weight-bold"},ee={class:"d-flex justify-space-between align-center"},te={class:"text-h5 font-weight-bold"},le={class:"d-flex justify-space-between align-center"},se={class:"text-h5 font-weight-bold"},ae={class:"text-h6 font-weight-bold"},oe={class:"text-h6 font-weight-bold text-warning"},ie={class:"text-h6 font-weight-bold text-info"},de={class:"text-h6 font-weight-bold text-success"},ne={class:"wallet-stat-box wallet-credit"},re={class:"d-flex align-center mb-2"},ue={class:"text-h5 font-weight-bold text-success"},me={class:"wallet-stat-box wallet-debit"},fe={class:"d-flex align-center mb-2"},ce={class:"text-h5 font-weight-bold text-error"},ve={class:"wallet-stat-box wallet-pending"},pe={class:"d-flex align-center justify-space-between"},_e={class:"d-flex align-center mb-2"},be={class:"text-h4 font-weight-bold text-warning"},xe={__name:"Dashboard",setup(ge){const _=L(),w=f(!1),y=f("today"),b=f(null),x=f(null),n=f({}),C=f([]),V=f([]),P=f(""),F=[{title:"Today",value:"today"},{title:"This Week",value:"week"},{title:"This Month",value:"month"},{title:"This Year",value:"year"}],S=()=>{const o=new Date;P.value=o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})};let h;const m=o=>new Intl.NumberFormat("en-NG").format(o),p=async()=>{w.value=!0;try{const o={period:y.value};b.value&&(o.branch_id=b.value),x.value&&(o.store_id=x.value);const e=await k.get("/api/reports/dashboard",{params:o});n.value=e.data}catch(o){console.error("Failed to load dashboard data:",o)}finally{w.value=!1}},D=o=>Array.isArray(o)?o:Array.isArray(o==null?void 0:o.data)?o.data:[];return E(async()=>{if(S(),h=setInterval(S,1e3),_.hasPermission("view_branches")){const o=await k.get("/api/branches");C.value=D(o==null?void 0:o.data)}if(_.hasPermission("view_stores")){const o=await k.get("/api/stores");V.value=D(o==null?void 0:o.data)}p()}),G(()=>{h&&clearInterval(h)}),(o,e)=>(g(),H("div",null,[t(c,{class:"mb-4"},{default:l(()=>[t(i,{cols:"12",md:"6"},{default:l(()=>[s("div",J,[t(M,{color:"primary",size:"48",class:"mr-4"},{default:l(()=>[t(r,{size:"28"},{default:l(()=>[...e[4]||(e[4]=[d("mdi-view-dashboard",-1)])]),_:1})]),_:1}),e[5]||(e[5]=s("div",null,[s("h1",{class:"text-h4 font-weight-bold mb-1"},"Dashboard"),s("p",{class:"text-subtitle-1 text-grey mb-0"},"Welcome back! Here's what's happening today.")],-1))])]),_:1}),t(i,{cols:"12",md:"6",class:"d-flex align-center justify-end"},{default:l(()=>[t(A,{color:"success",variant:"flat",class:"mr-2"},{default:l(()=>[t(r,{left:"",size:"small"},{default:l(()=>[...e[6]||(e[6]=[d("mdi-circle",-1)])]),_:1}),e[7]||(e[7]=d(" System Online ",-1))]),_:1}),t(A,{variant:"outlined"},{default:l(()=>[t(r,{left:"",size:"small"},{default:l(()=>[...e[8]||(e[8]=[d("mdi-clock-outline",-1)])]),_:1}),d(" "+u(P.value),1)]),_:1})]),_:1})]),_:1}),t(c,{class:"mb-2"},{default:l(()=>[t(i,{cols:"12",md:"3"},{default:l(()=>[t(B,{modelValue:y.value,"onUpdate:modelValue":[e[0]||(e[0]=a=>y.value=a),p],items:F,label:"Period",variant:"outlined",density:"comfortable","prepend-inner-icon":"mdi-calendar","hide-details":""},null,8,["modelValue"])]),_:1}),I(_).hasPermission("view_branches")?(g(),z(i,{key:0,cols:"12",md:"3"},{default:l(()=>[t(B,{modelValue:b.value,"onUpdate:modelValue":[e[1]||(e[1]=a=>b.value=a),p],items:C.value,"item-title":"name","item-value":"id",label:"Branch",variant:"outlined",density:"comfortable","prepend-inner-icon":"mdi-office-building",clearable:"","hide-details":""},null,8,["modelValue","items"])]),_:1})):T("",!0),I(_).hasPermission("view_stores")?(g(),z(i,{key:1,cols:"12",md:"3"},{default:l(()=>[t(Y,{modelValue:x.value,"onUpdate:modelValue":[e[2]||(e[2]=a=>x.value=a),p],items:V.value,"item-title":"name","item-value":"id",label:"Store",variant:"outlined",density:"comfortable","prepend-inner-icon":"mdi-store",clearable:"","hide-details":"",onCreated:e[3]||(e[3]=a=>V.value.push(a))},null,8,["modelValue","items"])]),_:1})):T("",!0),t(i,{cols:"12",md:"3",class:"d-flex align-center"},{default:l(()=>[t(N,{color:"primary",variant:"flat","prepend-icon":"mdi-refresh",onClick:p,block:""},{default:l(()=>[...e[9]||(e[9]=[d(" Refresh Data ",-1)])]),_:1})]),_:1})]),_:1}),t(c,null,{default:l(()=>[t(i,{cols:"12",sm:"6",md:"3"},{default:l(()=>[t(v,{elevation:"1",class:"pa-4"},{default:l(()=>{var a;return[s("div",K,[s("div",null,[e[10]||(e[10]=s("div",{class:"text-caption text-grey mb-1"},"Total Sales",-1)),s("div",Q,u(m(((a=n.value.sales)==null?void 0:a.total_sales)||0)),1)]),t(r,{size:"40",color:"primary"},{default:l(()=>[...e[11]||(e[11]=[d("mdi-cart",-1)])]),_:1})])]}),_:1})]),_:1}),t(i,{cols:"12",sm:"6",md:"3"},{default:l(()=>[t(v,{elevation:"1",class:"pa-4"},{default:l(()=>{var a;return[s("div",X,[s("div",null,[e[12]||(e[12]=s("div",{class:"text-caption text-grey mb-1"},"Revenue",-1)),s("div",Z,"₦"+u(m(((a=n.value.sales)==null?void 0:a.total_revenue)||0)),1)]),t(r,{size:"40",color:"success"},{default:l(()=>[...e[13]||(e[13]=[d("mdi-cash-multiple",-1)])]),_:1})])]}),_:1})]),_:1}),t(i,{cols:"12",sm:"6",md:"3"},{default:l(()=>[t(v,{elevation:"1",class:"pa-4"},{default:l(()=>{var a;return[s("div",ee,[s("div",null,[e[14]||(e[14]=s("div",{class:"text-caption text-grey mb-1"},"Profit",-1)),s("div",te,"₦"+u(m(((a=n.value.sales)==null?void 0:a.total_profit)||0)),1)]),t(r,{size:"40",color:"info"},{default:l(()=>[...e[15]||(e[15]=[d("mdi-chart-line",-1)])]),_:1})])]}),_:1})]),_:1}),t(i,{cols:"12",sm:"6",md:"3"},{default:l(()=>[t(v,{elevation:"1",class:"pa-4"},{default:l(()=>{var a;return[s("div",le,[s("div",null,[e[16]||(e[16]=s("div",{class:"text-caption text-grey mb-1"},"Low Stock Items",-1)),s("div",se,u(m(((a=n.value.inventory)==null?void 0:a.low_stock_items)||0)),1)]),t(r,{size:"40",color:"warning"},{default:l(()=>[...e[17]||(e[17]=[d("mdi-alert",-1)])]),_:1})])]}),_:1})]),_:1})]),_:1}),t(c,null,{default:l(()=>[t(i,{cols:"12",md:"6"},{default:l(()=>[t(v,{elevation:"1"},{default:l(()=>[t(O,{class:"d-flex align-center"},{default:l(()=>[t(r,{class:"mr-2"},{default:l(()=>[...e[18]||(e[18]=[d("mdi-clipboard-list",-1)])]),_:1}),e[19]||(e[19]=s("span",null,"Orders Overview",-1))]),_:1}),t(U),t(W,null,{default:l(()=>[t(c,null,{default:l(()=>[t(i,{cols:"6"},{default:l(()=>{var a;return[e[20]||(e[20]=s("div",{class:"text-caption text-grey"},"Total Orders",-1)),s("div",ae,u(m(((a=n.value.orders)==null?void 0:a.total_orders)||0)),1)]}),_:1}),t(i,{cols:"6"},{default:l(()=>{var a;return[e[21]||(e[21]=s("div",{class:"text-caption text-grey"},"Pending",-1)),s("div",oe,u(m(((a=n.value.orders)==null?void 0:a.pending_orders)||0)),1)]}),_:1}),t(i,{cols:"6"},{default:l(()=>{var a;return[e[22]||(e[22]=s("div",{class:"text-caption text-grey"},"Confirmed",-1)),s("div",ie,u(m(((a=n.value.orders)==null?void 0:a.confirmed_orders)||0)),1)]}),_:1}),t(i,{cols:"6"},{default:l(()=>{var a;return[e[23]||(e[23]=s("div",{class:"text-caption text-grey"},"Completed",-1)),s("div",de,u(m(((a=n.value.orders)==null?void 0:a.completed_orders)||0)),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(i,{cols:"12",md:"6"},{default:l(()=>[t(v,{class:"detail-card",elevation:"2"},{default:l(()=>[t(O,{class:"d-flex align-center pa-6 pb-4"},{default:l(()=>[t(r,{color:"success",class:"mr-2"},{default:l(()=>[...e[24]||(e[24]=[d("mdi-wallet",-1)])]),_:1}),e[25]||(e[25]=s("span",{class:"font-weight-bold"},"Wallet Overview",-1))]),_:1}),t(U),t(W,{class:"pa-6"},{default:l(()=>[t(c,null,{default:l(()=>[t(i,{cols:"6",class:"mb-4"},{default:l(()=>{var a;return[s("div",ne,[s("div",re,[t(r,{color:"success",size:"small",class:"mr-2"},{default:l(()=>[...e[26]||(e[26]=[d("mdi-arrow-down-circle",-1)])]),_:1}),e[27]||(e[27]=s("span",{class:"text-caption text-grey"},"Total Credits",-1))]),s("div",ue,"₦"+u(m(((a=n.value.wallet)==null?void 0:a.total_credits)||0)),1)])]}),_:1}),t(i,{cols:"6",class:"mb-4"},{default:l(()=>{var a;return[s("div",me,[s("div",fe,[t(r,{color:"error",size:"small",class:"mr-2"},{default:l(()=>[...e[28]||(e[28]=[d("mdi-arrow-up-circle",-1)])]),_:1}),e[29]||(e[29]=s("span",{class:"text-caption text-grey"},"Total Debits",-1))]),s("div",ce,"₦"+u(m(((a=n.value.wallet)==null?void 0:a.total_debits)||0)),1)])]}),_:1}),t(i,{cols:"12"},{default:l(()=>{var a,j;return[s("div",ve,[s("div",pe,[s("div",null,[s("div",_e,[t(r,{color:"warning",size:"small",class:"mr-2"},{default:l(()=>[...e[30]||(e[30]=[d("mdi-clock-alert",-1)])]),_:1}),e[31]||(e[31]=s("span",{class:"text-caption text-grey"},"Pending Approvals",-1))]),s("div",be,u(((a=n.value.wallet)==null?void 0:a.pending_approvals)||0),1)]),((j=n.value.wallet)==null?void 0:j.pending_approvals)>0?(g(),z(N,{key:0,color:"warning",variant:"flat",size:"small",to:"/wallet"},{default:l(()=>[...e[32]||(e[32]=[d(" Review ",-1)])]),_:1})):T("",!0)])])]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(q,{"model-value":w.value,class:"align-center justify-center"},{default:l(()=>[t(R,{indeterminate:"",size:"64",color:"primary"})]),_:1},8,["model-value"])]))}},ze=$(xe,[["__scopeId","data-v-06ae10e4"]]);export{ze as default};
