import{b as Ot,ac as Ut,r as _,c as k,o as Rt,a2 as z,e as x,f as c,h as a,g as V,j as g,w as e,v as b,i as s,P as w,p as n,G as u,t as r,s as v,V as f,N as A,q as M,W as O,m as st,E as G,U as jt,ap as Et,X as U,a4 as ot,n as y,ad as $t,aq as W,F as nt,ar as Lt,H as it,as as Bt,ag as qt,ah as Gt,T as rt,at as Wt,au as dt,J as ut,K as mt,a9 as Yt,aa as Ht}from"./app-CJq9zEpr.js";import{S as Jt}from"./SaleReceipt-DvPNCtIt.js";import{_ as Kt}from"./StoreSelect-CUGTwINW.js";import{_ as Qt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./appSettings-DlaUMDbI.js";import"./useToast-DKMsU9PD.js";import"./AddNewSelect-Cy-bT142.js";const Xt={class:"sales-history-container"},Zt={class:"d-flex align-center justify-space-between mb-4"},te={class:"d-flex align-center justify-space-between"},ee={class:"text-h5 font-weight-bold"},ae={class:"d-flex align-center justify-space-between"},le={class:"text-h5 font-weight-bold"},se={class:"d-flex align-center justify-space-between"},oe={class:"text-h5 font-weight-bold"},ne={class:"d-flex align-center justify-space-between"},ie={class:"text-h5 font-weight-bold"},re={class:"d-flex justify-end mt-4"},de={class:"d-flex align-center gap-2"},ue={class:"d-flex align-center"},me=["onClick"],ce={class:"d-flex flex-column"},pe={class:"text-body-2"},ve={class:"text-caption text-grey"},fe={class:"d-flex align-center"},_e={class:"d-flex flex-column align-end"},ye={class:"text-body-1 font-weight-bold text-primary"},ge={class:"d-flex gap-1"},xe={class:"text-center py-8"},be={class:"pa-4 d-flex justify-space-between align-center"},we={class:"text-body-2 text-grey"},he={class:"text-h6"},ke={class:"text-h6"},Ve={class:"text-h6"},Se={key:0,class:"mb-6"},Te={class:"d-flex align-center"},Ce={class:"text-grey"},Fe={class:"text-right font-weight-bold"},Pe={class:"text-right text-success text-h6"},De={class:"d-flex align-center"},ze={class:"font-weight-medium"},Ie={class:"text-caption text-grey"},Ne={class:"text-center"},Ae={class:"text-right font-weight-medium"},Me={class:"text-right font-weight-bold"},Oe={class:"d-flex justify-space-between mb-3"},Ue={class:"font-weight-medium"},Re={key:0,class:"d-flex justify-space-between mb-3"},je={class:"font-weight-medium text-error"},Ee={key:1,class:"d-flex justify-space-between mb-3"},$e={class:"font-weight-medium"},Le={class:"d-flex justify-space-between text-h6 mb-4"},Be={class:"text-primary font-weight-bold"},qe={class:"d-flex justify-space-between"},Ge={class:"text-success font-weight-bold"},We={key:2,class:"d-flex justify-space-between mt-2"},Ye={class:"text-success"},He={key:3,class:"d-flex justify-space-between mt-2"},Je={class:"text-warning font-weight-bold"},Ke={__name:"SalesList",setup(Qe){const Y=Ot(),{alert:R,confirm:ct}=Ut(),j=_(!1),C=_(!1),F=_([]),I=_([]),i=_(null),N=_(15),P=_(1),E=_(!1),$=_(null),L=_(!1),D=_([]),m=_({search:"",store_id:null,date_from:"",date_to:"",sale_type:null,payment_status:null}),pt=[{title:"POS Sale",value:"pos"},{title:"Online Order",value:"order"},{title:"Invoice",value:"invoice"}],vt=[{title:"Paid",value:"paid"},{title:"Pending",value:"pending"},{title:"Partial",value:"partial"},{title:"Verified",value:"verified"}],ft=[{title:"INVOICE #",key:"invoice_number",sortable:!0,width:"180px"},{title:"DATE & TIME",key:"sale_date",sortable:!0,width:"160px"},{title:"CUSTOMER",key:"customer",sortable:!0},{title:"TYPE",key:"sale_type",sortable:!0,width:"120px"},{title:"AMOUNT",key:"total_amount",sortable:!0,align:"end",width:"150px"},{title:"PAYMENT",key:"payment_status",sortable:!0,width:"130px"},{title:"STATUS",key:"is_voided",sortable:!0,width:"120px"},{title:"ACTIONS",key:"actions",sortable:!1,align:"center",width:"140px"}],S=k(()=>F.value.filter(o=>{var et,at,lt;const t=!m.value.search||((et=o.invoice_number)==null?void 0:et.toLowerCase().includes(m.value.search.toLowerCase()))||((lt=(at=o.customer)==null?void 0:at.name)==null?void 0:lt.toLowerCase().includes(m.value.search.toLowerCase())),l=!m.value.store_id||o.store_id===m.value.store_id,d=!m.value.sale_type||o.sale_type===m.value.sale_type,T=!m.value.payment_status||o.payment_status===m.value.payment_status;return t&&l&&d&&T})),H=k(()=>S.value.reduce((o,t)=>o+(parseFloat(t.total_amount)||0),0)),_t=k(()=>{const o=new Date().toISOString().split("T")[0];return F.value.filter(t=>{var l;return((l=t.sale_date)==null?void 0:l.split("T")[0])===o}).reduce((t,l)=>t+(parseFloat(l.total_amount)||0),0)}),B=k(()=>S.value.length),yt=k(()=>F.value.filter(o=>["pending","partial"].includes(o.payment_status)).length),gt=k(()=>B.value>0?H.value/B.value:0),J=k(()=>{if(D.value.length===2){const[o,t]=D.value;return`${q(o)} - ${q(t)}`}return"Select date range"}),xt=k(()=>(P.value-1)*N.value+1),bt=k(()=>Math.min(P.value*N.value,S.value.length)),p=o=>o==null||isNaN(o)?"0.00":new Intl.NumberFormat("en-NG",{minimumFractionDigits:2,maximumFractionDigits:2}).format(parseFloat(o)),q=o=>o?new Date(o).toLocaleDateString("en-NG"):"",wt=o=>o?new Date(o).toLocaleTimeString("en-NG",{hour:"2-digit",minute:"2-digit"}):"",ht=o=>o?new Date(o).toLocaleDateString("en-NG",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",kt=o=>({paid:"Paid",pending:"Pending",partial:"Partial",verified:"Verified"})[o]||o,Vt=o=>({pos:"primary",order:"success",invoice:"info"})[o]||"grey",St=o=>({pos:"mdi-cash-register",order:"mdi-cart",invoice:"mdi-file-document"})[o]||"mdi-receipt",Tt=o=>({paid:"success",pending:"warning",partial:"info",verified:"success"})[o]||"grey",Ct=o=>({paid:"mdi-check-circle",pending:"mdi-clock",partial:"mdi-progress-clock",verified:"mdi-shield-check"})[o]||"mdi-help-circle",K=o=>({cash:"success",card:"primary",bank_transfer:"info",wallet:"purple",mixed:"orange"})[o]||"grey",Ft=o=>({cash:"mdi-cash",card:"mdi-credit-card",bank_transfer:"mdi-bank-transfer",wallet:"mdi-wallet",mixed:"mdi-cash-multiple"})[o]||"mdi-currency-usd",Q=o=>({cash:"Cash",card:"Card",bank_transfer:"Bank Transfer",wallet:"Wallet",mixed:"Mixed Payment"})[o]||o,Pt=o=>o.payments&&o.payments.length>1,Dt=zt(()=>h(),300);function zt(o,t){let l;return function(...d){clearTimeout(l),l=setTimeout(()=>o.apply(this,d),t)}}const It=o=>{o.length===2&&(m.value.date_from=o[0],m.value.date_to=o[1],h(),L.value=!1)},Nt=()=>{m.value={search:"",store_id:null,date_from:"",date_to:"",sale_type:null,payment_status:null},D.value=[],h()},h=async()=>{j.value=!0;try{const o=await z.get("/api/sales",{params:m.value});F.value=o.data.data||o.data,F.value=F.value.map(t=>({...t,subtotal_amount:parseFloat(t.subtotal_amount||t.subtotal||0),discount_amount:parseFloat(t.discount_amount||0),tax_amount:parseFloat(t.tax_amount||0),total_amount:parseFloat(t.total_amount||0),amount_paid:parseFloat(t.amount_paid||0),change_amount:parseFloat(t.change_amount||0),outstanding_amount:parseFloat(t.outstanding_amount||0)}))}catch(o){console.error("Failed to load sales:",o)}finally{j.value=!1}},X=async o=>{try{const t=await z.get(`/api/sales/${o.id}`);i.value=t.data,i.value&&(i.value.subtotal_amount=parseFloat(i.value.subtotal_amount||i.value.subtotal||0),i.value.discount_amount=parseFloat(i.value.discount_amount||0),i.value.tax_amount=parseFloat(i.value.tax_amount||0),i.value.total_amount=parseFloat(i.value.total_amount||0),i.value.amount_paid=parseFloat(i.value.amount_paid||0),i.value.change_amount=parseFloat(i.value.change_amount||0),i.value.outstanding_amount=parseFloat(i.value.outstanding_amount||0),i.value.items&&(i.value.items=i.value.items.map(l=>({...l,subtotal:parseFloat(l.subtotal||l.quantity*l.unit_price||0)})))),C.value=!0}catch(t){console.error("Failed to load sale details:",t)}},Z=async o=>{var t;try{let l=o;(!o.items||!o.payments)&&(l=(await z.get(`/api/sales/${o.id}`)).data),l={...l,subtotal:l.subtotal_amount||l.subtotal||0,subtotal_amount:parseFloat(l.subtotal_amount||l.subtotal||0),discount_amount:parseFloat(l.discount_amount||0),tax_amount:parseFloat(l.tax_amount||0),total_amount:parseFloat(l.total_amount||0),amount_paid:parseFloat(l.amount_paid||0),change_amount:parseFloat(l.change_amount||0),outstanding_amount:parseFloat(l.outstanding_amount||0),items:((t=l.items)==null?void 0:t.map(d=>({...d,line_total:parseFloat(d.line_total||d.subtotal||d.quantity*d.unit_price||0),subtotal:parseFloat(d.subtotal||d.quantity*d.unit_price||0)})))||[]},$.value=l,E.value=!0}catch(l){console.error("Failed to load receipt:",l),R("Failed to load receipt")}},tt=async o=>{if(await ct(`Are you sure you want to void sale ${o.invoice_number}? This action cannot be undone.`))try{await z.post(`/api/sales/${o.id}/void`),h(),C.value=!1}catch(l){console.error("Failed to void sale:",l),R("Failed to void sale")}},At=()=>{R("CSV export feature would be implemented here")},Mt=()=>{window.print()};return Rt(async()=>{try{const o=await z.get("/api/stores");I.value=o.data.data||o.data}catch(o){console.error("Failed to load stores:",o),I.value=[]}await h()}),(o,t)=>(c(),x("div",Xt,[a(v,{class:"mb-6",elevation:"2"},{default:e(()=>[a(b,{class:"pa-6"},{default:e(()=>[s("div",Zt,[t[16]||(t[16]=s("div",null,[s("h1",{class:"text-h4 font-weight-bold text-primary"},"Sales History"),s("p",{class:"text-body-1 text-grey-darken-1 mt-2"},"Track and manage all sales transactions")],-1)),a(w,{variant:"outlined",color:"primary",class:"px-4 py-2"},{default:e(()=>[a(u,{start:""},{default:e(()=>[...t[15]||(t[15]=[n("mdi-chart-line",-1)])]),_:1}),n(" Total Sales: ₦"+r(p(H.value)),1)]),_:1})])]),_:1})]),_:1}),a(M,{class:"mb-6"},{default:e(()=>[a(f,{cols:"12",sm:"6",md:"3"},{default:e(()=>[a(v,{elevation:"2",class:A(["summary-card",{"border-left-success":!0}])},{default:e(()=>[a(b,{class:"pa-4"},{default:e(()=>[s("div",te,[s("div",null,[t[17]||(t[17]=s("p",{class:"text-body-2 text-grey-darken-1 mb-1"},"Today's Sales",-1)),s("h2",ee,"₦"+r(p(_t.value)),1)]),a(u,{color:"success",size:"40"},{default:e(()=>[...t[18]||(t[18]=[n("mdi-cash-multiple",-1)])]),_:1})])]),_:1})]),_:1})]),_:1}),a(f,{cols:"12",sm:"6",md:"3"},{default:e(()=>[a(v,{elevation:"2",class:A(["summary-card",{"border-left-primary":!0}])},{default:e(()=>[a(b,{class:"pa-4"},{default:e(()=>[s("div",ae,[s("div",null,[t[19]||(t[19]=s("p",{class:"text-body-2 text-grey-darken-1 mb-1"},"Total Orders",-1)),s("h2",le,r(B.value),1)]),a(u,{color:"primary",size:"40"},{default:e(()=>[...t[20]||(t[20]=[n("mdi-shopping",-1)])]),_:1})])]),_:1})]),_:1})]),_:1}),a(f,{cols:"12",sm:"6",md:"3"},{default:e(()=>[a(v,{elevation:"2",class:A(["summary-card",{"border-left-warning":!0}])},{default:e(()=>[a(b,{class:"pa-4"},{default:e(()=>[s("div",se,[s("div",null,[t[21]||(t[21]=s("p",{class:"text-body-2 text-grey-darken-1 mb-1"},"Pending Payments",-1)),s("h2",oe,r(yt.value),1)]),a(u,{color:"warning",size:"40"},{default:e(()=>[...t[22]||(t[22]=[n("mdi-clock-outline",-1)])]),_:1})])]),_:1})]),_:1})]),_:1}),a(f,{cols:"12",sm:"6",md:"3"},{default:e(()=>[a(v,{elevation:"2",class:A(["summary-card",{"border-left-info":!0}])},{default:e(()=>[a(b,{class:"pa-4"},{default:e(()=>[s("div",ne,[s("div",null,[t[23]||(t[23]=s("p",{class:"text-body-2 text-grey-darken-1 mb-1"},"Average Order Value",-1)),s("h2",ie,"₦"+r(p(gt.value)),1)]),a(u,{color:"info",size:"40"},{default:e(()=>[...t[24]||(t[24]=[n("mdi-chart-bar",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),a(v,{class:"mb-6",elevation:"2"},{default:e(()=>[a(O,{class:"bg-grey-lighten-4"},{default:e(()=>[a(u,{start:""},{default:e(()=>[...t[25]||(t[25]=[n("mdi-filter",-1)])]),_:1}),t[26]||(t[26]=n(" Filters ",-1))]),_:1}),a(b,{class:"pa-4"},{default:e(()=>[a(M,null,{default:e(()=>[a(f,{cols:"12",md:"4"},{default:e(()=>[a(st,{modelValue:m.value.search,"onUpdate:modelValue":t[0]||(t[0]=l=>m.value.search=l),label:"Search invoices or customers","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"comfortable",clearable:"","hide-details":"",onInput:G(Dt)},null,8,["modelValue","onInput"])]),_:1}),a(f,{cols:"12",md:"2"},{default:e(()=>[a(Kt,{modelValue:m.value.store_id,"onUpdate:modelValue":[t[1]||(t[1]=l=>m.value.store_id=l),h],items:I.value,"item-title":"name","item-value":"id",label:"Store",variant:"outlined",density:"comfortable",clearable:"","hide-details":"",onCreated:t[2]||(t[2]=l=>I.value.push(l))},null,8,["modelValue","items"])]),_:1}),a(f,{cols:"12",md:"2"},{default:e(()=>[a(jt,{modelValue:L.value,"onUpdate:modelValue":t[5]||(t[5]=l=>L.value=l),"close-on-content-click":!1},{activator:e(({props:l})=>[a(st,U({modelValue:J.value,"onUpdate:modelValue":t[3]||(t[3]=d=>J.value=d),label:"Date Range","prepend-inner-icon":"mdi-calendar",variant:"outlined",density:"comfortable",readonly:"","hide-details":""},l),null,16,["modelValue"])]),default:e(()=>[a(Et,{modelValue:D.value,"onUpdate:modelValue":[t[4]||(t[4]=l=>D.value=l),It],range:""},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),a(f,{cols:"12",md:"2"},{default:e(()=>[a(ot,{modelValue:m.value.sale_type,"onUpdate:modelValue":[t[6]||(t[6]=l=>m.value.sale_type=l),h],items:pt,label:"Sale Type",variant:"outlined",density:"comfortable",clearable:"","hide-details":""},null,8,["modelValue"])]),_:1}),a(f,{cols:"12",md:"2"},{default:e(()=>[a(ot,{modelValue:m.value.payment_status,"onUpdate:modelValue":[t[7]||(t[7]=l=>m.value.payment_status=l),h],items:vt,label:"Payment Status",variant:"outlined",density:"comfortable",clearable:"","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),s("div",re,[a(y,{variant:"text",color:"grey",onClick:Nt,"prepend-icon":"mdi-refresh"},{default:e(()=>[...t[27]||(t[27]=[n(" Reset Filters ",-1)])]),_:1}),a(y,{color:"primary",onClick:h,"prepend-icon":"mdi-filter-apply"},{default:e(()=>[...t[28]||(t[28]=[n(" Apply Filters ",-1)])]),_:1})])]),_:1})]),_:1}),a(v,{elevation:"2"},{default:e(()=>[a(O,{class:"bg-grey-lighten-4 d-flex align-center justify-space-between"},{default:e(()=>[s("div",null,[t[29]||(t[29]=s("span",{class:"text-h6 font-weight-bold"},"Sales Transactions",-1)),a(w,{variant:"tonal",color:"primary",size:"small",class:"ml-2"},{default:e(()=>[n(r(S.value.length)+" records ",1)]),_:1})]),s("div",de,[a(y,{variant:"tonal",color:"success","prepend-icon":"mdi-download",onClick:At,size:"small"},{default:e(()=>[...t[30]||(t[30]=[n(" Export ",-1)])]),_:1}),a(y,{variant:"tonal",color:"primary","prepend-icon":"mdi-printer",onClick:Mt,size:"small"},{default:e(()=>[...t[31]||(t[31]=[n(" Print ",-1)])]),_:1})])]),_:1}),a($t,{headers:ft,items:S.value,loading:j.value,"items-per-page":N.value,page:P.value,"sort-by":[{key:"sale_date",order:"desc"}],class:"elevation-1"},{loading:e(()=>[a(Lt,{type:"table-row@6"})]),"item.invoice_number":e(({item:l})=>[s("div",ue,[a(u,{color:"primary",size:"small",class:"mr-2"},{default:e(()=>[...t[32]||(t[32]=[n("mdi-receipt",-1)])]),_:1}),s("a",{onClick:d=>X(l),class:"text-primary text-decoration-none font-weight-medium cursor-pointer"},r(l.invoice_number),9,me)])]),"item.sale_date":e(({item:l})=>[s("div",ce,[s("span",pe,r(q(l.sale_date)),1),s("span",ve,r(wt(l.sale_date)),1)])]),"item.customer":e(({item:l})=>{var d;return[s("div",fe,[a(nt,{size:"28",color:"primary",class:"mr-2"},{default:e(()=>[a(u,{color:"white",size:"small"},{default:e(()=>[...t[33]||(t[33]=[n("mdi-account",-1)])]),_:1})]),_:1}),s("span",null,r(((d=l.customer)==null?void 0:d.name)||"Walk-in Customer"),1)])]}),"item.sale_type":e(({item:l})=>[a(w,{color:Vt(l.sale_type),size:"small",variant:l.sale_type==="pos"?"flat":"tonal",class:"font-weight-medium"},{default:e(()=>[a(u,{start:"",size:"small"},{default:e(()=>[n(r(St(l.sale_type)),1)]),_:2},1024),n(" "+r(l.sale_type.toUpperCase()),1)]),_:2},1032,["color","variant"])]),"item.total_amount":e(({item:l})=>[s("div",_e,[s("span",ye," ₦"+r(p(l.total_amount)),1),l.discount_amount>0?(c(),V(w,{key:0,size:"x-small",color:"error",variant:"tonal",class:"mt-1"},{default:e(()=>[n(" -₦"+r(p(l.discount_amount)),1)]),_:2},1024)):g("",!0)])]),"item.payment_status":e(({item:l})=>[a(w,{color:Tt(l.payment_status),size:"small",variant:l.payment_status==="paid"?"flat":"tonal",class:"font-weight-medium"},{default:e(()=>[a(u,{start:"",size:"small"},{default:e(()=>[n(r(Ct(l.payment_status)),1)]),_:2},1024),n(" "+r(kt(l.payment_status)),1)]),_:2},1032,["color","variant"])]),"item.is_voided":e(({item:l})=>[l.is_voided?(c(),V(w,{key:0,color:"error",size:"small",variant:"flat",class:"font-weight-medium"},{default:e(()=>[a(u,{start:"",size:"small"},{default:e(()=>[...t[34]||(t[34]=[n("mdi-cancel",-1)])]),_:1}),t[35]||(t[35]=n(" VOIDED ",-1))]),_:1})):(c(),V(w,{key:1,color:"success",size:"small",variant:"tonal"},{default:e(()=>[a(u,{start:"",size:"small"},{default:e(()=>[...t[36]||(t[36]=[n("mdi-check-circle",-1)])]),_:1}),t[37]||(t[37]=n(" Active ",-1))]),_:1}))]),"item.actions":e(({item:l})=>[s("div",ge,[a(W,{text:"View Details",location:"top"},{activator:e(({props:d})=>[a(y,U(d,{icon:"",size:"small",variant:"text",color:"primary",onClick:T=>X(l)}),{default:e(()=>[a(u,null,{default:e(()=>[...t[38]||(t[38]=[n("mdi-eye-outline",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024),a(W,{text:"Print Receipt",location:"top"},{activator:e(({props:d})=>[a(y,U(d,{icon:"",size:"small",variant:"text",color:"success",onClick:T=>Z(l)}),{default:e(()=>[a(u,null,{default:e(()=>[...t[39]||(t[39]=[n("mdi-printer-outline",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024),!l.is_voided&&G(Y).hasPermission("void_sales")?(c(),V(W,{key:0,text:"Void Sale",location:"top"},{activator:e(({props:d})=>[a(y,U(d,{icon:"",size:"small",variant:"text",color:"error",onClick:T=>tt(l)}),{default:e(()=>[a(u,null,{default:e(()=>[...t[40]||(t[40]=[n("mdi-close-circle-outline",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024)):g("",!0)])]),"no-data":e(()=>[s("div",xe,[a(u,{size:"64",color:"grey-lighten-1"},{default:e(()=>[...t[41]||(t[41]=[n("mdi-receipt-text-off",-1)])]),_:1}),t[43]||(t[43]=s("h3",{class:"text-h6 mt-4 text-grey"},"No sales found",-1)),t[44]||(t[44]=s("p",{class:"text-grey mt-2"},"Try adjusting your filters or create a new sale",-1)),a(y,{color:"primary",class:"mt-4","prepend-icon":"mdi-plus"},{default:e(()=>[...t[42]||(t[42]=[n(" Create New Sale ",-1)])]),_:1})])]),_:1},8,["items","loading","items-per-page","page"]),a(it),s("div",be,[s("div",we," Showing "+r(xt.value)+"-"+r(bt.value)+" of "+r(S.value.length)+" records ",1),a(Bt,{modelValue:P.value,"onUpdate:modelValue":t[8]||(t[8]=l=>P.value=l),length:Math.ceil(S.value.length/N.value),"total-visible":5,rounded:"circle"},null,8,["modelValue","length"])])]),_:1}),a(Ht,{modelValue:C.value,"onUpdate:modelValue":t[13]||(t[13]=l=>C.value=l),"max-width":"900px",scrollable:""},{default:e(()=>[i.value?(c(),V(v,{key:0,class:"elevation-3"},{default:e(()=>[a(qt,{color:"primary",dark:""},{default:e(()=>[a(Gt,null,{default:e(()=>[a(u,{start:""},{default:e(()=>[...t[45]||(t[45]=[n("mdi-receipt",-1)])]),_:1}),n(" Sale Details - "+r(i.value.invoice_number),1)]),_:1}),a(rt),i.value.is_voided?(c(),V(w,{key:0,color:"error",variant:"flat",class:"mr-2"},{default:e(()=>[a(u,{start:""},{default:e(()=>[...t[46]||(t[46]=[n("mdi-cancel",-1)])]),_:1}),t[47]||(t[47]=n(" VOIDED ",-1))]),_:1})):g("",!0),a(Wt,null,{default:e(()=>[a(y,{icon:"",onClick:t[9]||(t[9]=l=>C.value=!1)},{default:e(()=>[a(u,null,{default:e(()=>[...t[48]||(t[48]=[n("mdi-close",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),a(b,{class:"pa-6"},{default:e(()=>[a(M,{class:"mb-6"},{default:e(()=>[a(f,{cols:"12",md:"4"},{default:e(()=>[a(v,{variant:"outlined",class:"pa-3"},{default:e(()=>[t[49]||(t[49]=s("div",{class:"text-caption text-grey mb-1"},"SALE DATE",-1)),s("div",he,r(ht(i.value.sale_date)),1)]),_:1})]),_:1}),a(f,{cols:"12",md:"4"},{default:e(()=>[a(v,{variant:"outlined",class:"pa-3"},{default:e(()=>{var l;return[t[50]||(t[50]=s("div",{class:"text-caption text-grey mb-1"},"CUSTOMER",-1)),s("div",ke,r(((l=i.value.customer)==null?void 0:l.name)||"Walk-in Customer"),1)]}),_:1})]),_:1}),a(f,{cols:"12",md:"4"},{default:e(()=>[a(v,{variant:"outlined",class:"pa-3"},{default:e(()=>[t[51]||(t[51]=s("div",{class:"text-caption text-grey mb-1"},"PAYMENT METHOD",-1)),s("div",Ve,[a(w,{color:K(i.value.payment_method),size:"small"},{default:e(()=>[n(r(Q(i.value.payment_method)),1)]),_:1},8,["color"])])]),_:1})]),_:1})]),_:1}),Pt(i.value)?(c(),x("div",Se,[a(v,{variant:"outlined"},{default:e(()=>[a(O,{class:"bg-grey-lighten-4"},{default:e(()=>[a(u,{start:""},{default:e(()=>[...t[52]||(t[52]=[n("mdi-credit-card-multiple",-1)])]),_:1}),t[53]||(t[53]=n(" Payment Breakdown ",-1))]),_:1}),a(b,{class:"pa-4"},{default:e(()=>[a(dt,null,{default:e(()=>[t[55]||(t[55]=s("thead",null,[s("tr",null,[s("th",null,"Method"),s("th",null,"Reference"),s("th",{class:"text-right"},"Amount")])],-1)),s("tbody",null,[(c(!0),x(ut,null,mt(i.value.payments,l=>(c(),x("tr",{key:l.id},[s("td",null,[s("div",Te,[a(u,{color:K(l.payment_method),class:"mr-2"},{default:e(()=>[n(r(Ft(l.payment_method)),1)]),_:2},1032,["color"]),n(" "+r(Q(l.payment_method)),1)])]),s("td",Ce,r(l.reference||"N/A"),1),s("td",Fe," ₦"+r(p(l.amount)),1)]))),128))]),s("tfoot",null,[s("tr",null,[t[54]||(t[54]=s("td",{colspan:"2",class:"text-right font-weight-bold"},"Total Paid:",-1)),s("td",Pe," ₦"+r(p(i.value.amount_paid)),1)])])]),_:1})]),_:1})]),_:1})])):g("",!0),a(v,{variant:"outlined",class:"mb-6"},{default:e(()=>[a(O,{class:"bg-grey-lighten-4"},{default:e(()=>[a(u,{start:""},{default:e(()=>[...t[56]||(t[56]=[n("mdi-cart",-1)])]),_:1}),t[57]||(t[57]=n(" Items Purchased ",-1))]),_:1}),a(b,{class:"pa-0"},{default:e(()=>[a(dt,null,{default:e(()=>[t[59]||(t[59]=s("thead",null,[s("tr",{class:"bg-grey-lighten-3"},[s("th",null,"PRODUCT"),s("th",{class:"text-center"},"QUANTITY"),s("th",{class:"text-right"},"UNIT PRICE"),s("th",{class:"text-right"},"SUBTOTAL")])],-1)),s("tbody",null,[(c(!0),x(ut,null,mt(i.value.items,l=>{var d,T;return c(),x("tr",{key:l.id},[s("td",null,[s("div",De,[a(nt,{size:"36",color:"grey-lighten-3",class:"mr-3"},{default:e(()=>[a(u,null,{default:e(()=>[...t[58]||(t[58]=[n("mdi-package-variant",-1)])]),_:1})]),_:1}),s("div",null,[s("div",ze,r((d=l.product)==null?void 0:d.name),1),s("div",Ie,r(((T=l.product)==null?void 0:T.sku)||"N/A"),1)])])]),s("td",Ne,[a(w,{size:"small",variant:"outlined"},{default:e(()=>[n(r(l.quantity),1)]),_:2},1024)]),s("td",Ae," ₦"+r(p(l.unit_price)),1),s("td",Me," ₦"+r(p(l.subtotal)),1)])}),128))])]),_:1})]),_:1})]),_:1}),a(M,null,{default:e(()=>[a(f,{cols:"12",md:"8"}),a(f,{cols:"12",md:"4"},{default:e(()=>[a(v,{variant:"outlined"},{default:e(()=>[a(b,{class:"pa-4"},{default:e(()=>[s("div",Oe,[t[60]||(t[60]=s("span",{class:"text-grey"},"Subtotal:",-1)),s("span",Ue,"₦"+r(p(i.value.subtotal_amount)),1)]),i.value.discount_amount>0?(c(),x("div",Re,[t[61]||(t[61]=s("span",{class:"text-grey"},"Discount:",-1)),s("span",je,"-₦"+r(p(i.value.discount_amount)),1)])):g("",!0),i.value.tax_amount>0?(c(),x("div",Ee,[t[62]||(t[62]=s("span",{class:"text-grey"},"Tax:",-1)),s("span",$e,"₦"+r(p(i.value.tax_amount)),1)])):g("",!0),a(it,{class:"my-3"}),s("div",Le,[t[63]||(t[63]=s("span",null,"Total:",-1)),s("span",Be,"₦"+r(p(i.value.total_amount)),1)]),s("div",qe,[t[64]||(t[64]=s("span",null,"Amount Paid:",-1)),s("span",Ge,"₦"+r(p(i.value.amount_paid)),1)]),i.value.change_amount>0?(c(),x("div",We,[t[65]||(t[65]=s("span",null,"Change:",-1)),s("span",Ye,"₦"+r(p(i.value.change_amount)),1)])):g("",!0),i.value.outstanding_amount>0?(c(),x("div",He,[t[66]||(t[66]=s("span",null,"Outstanding:",-1)),s("span",Je,"₦"+r(p(i.value.outstanding_amount)),1)])):g("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(Yt,{class:"pa-6"},{default:e(()=>[a(y,{color:"primary",variant:"flat",onClick:t[10]||(t[10]=l=>Z(i.value)),"prepend-icon":"mdi-printer"},{default:e(()=>[...t[67]||(t[67]=[n(" Print Receipt ",-1)])]),_:1}),a(y,{variant:"outlined",onClick:t[11]||(t[11]=l=>C.value=!1)},{default:e(()=>[...t[68]||(t[68]=[n("Close",-1)])]),_:1}),a(rt),!i.value.is_voided&&G(Y).hasPermission("void_sales")?(c(),V(y,{key:0,color:"error",variant:"tonal",onClick:t[12]||(t[12]=l=>tt(i.value)),"prepend-icon":"mdi-cancel"},{default:e(()=>[...t[69]||(t[69]=[n(" Void Sale ",-1)])]),_:1})):g("",!0)]),_:1})]),_:1})):g("",!0)]),_:1},8,["modelValue"]),$.value?(c(),V(Jt,{key:0,sale:$.value,show:E.value,onClose:t[14]||(t[14]=l=>E.value=!1)},null,8,["sale","show"])):g("",!0)]))}},oa=Qt(Ke,[["__scopeId","data-v-a45b18e0"]]);export{oa as default};
