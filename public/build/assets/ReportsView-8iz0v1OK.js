import{r as m,ac as z,o as E,a2 as w,e as K,f as b,h as t,w as e,V as o,i as s,q as k,al as I,p as r,am as Q,an as G,s as n,v as i,g as x,j as S,n as D,G as O,t as d,ad as B,ae as J,P as X,ao as Y}from"./app-CJq9zEpr.js";import{_ as N}from"./StoreSelect-CUGTwINW.js";import{_ as Z}from"./CategorySelect-CGcOVtdp.js";import{_ as T}from"./DatePickerField-ViH1nrtl.js";import"./useToast-DKMsU9PD.js";import"./AddNewSelect-Cy-bT142.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const h={class:"text-h5"},tt={class:"text-h5"},et={class:"text-h5"},lt={class:"text-h5"},at={class:"text-h5"},ot={class:"text-h5"},st={class:"text-h5"},ut={class:"text-h5"},dt={class:"text-h5"},rt={class:"text-h5"},nt={class:"text-h5"},Vt={__name:"ReportsView",setup(it){const C=m("sales"),y=m([]),R=m([]),{alert:$}=z(),P=m(!1),U=m(!1),F=m(!1),f=m(null),_=m(null),g=m(null),c=m({date_from:new Date().toISOString().split("T")[0],date_to:new Date().toISOString().split("T")[0],store_id:null}),p=m({store_id:null,category_id:null,low_stock_only:!1}),V=m({date_from:new Date().toISOString().split("T")[0],date_to:new Date().toISOString().split("T")[0],store_id:null}),L=[{title:"Date",key:"sale_date"},{title:"Invoice #",key:"invoice_number"},{title:"Customer",key:"customer.name"},{title:"Amount",key:"total_amount"},{title:"Discount",key:"discount_amount"}],q=[{title:"SKU",key:"sku"},{title:"Product",key:"name"},{title:"Category",key:"category"},{title:"Quantity",key:"current_quantity"},{title:"Stock Value",key:"stock_value"},{title:"Status",key:"status"}],v=u=>new Intl.NumberFormat("en-NG").format(u),A=async()=>{P.value=!0;try{const u=await w.get("/api/reports/sales",{params:c.value});f.value=u.data}catch(u){console.error("Failed to load sales report:",u)}finally{P.value=!1}},H=async()=>{if(!p.value.store_id){$("Please select a store");return}U.value=!0;try{const u=await w.get("/api/reports/inventory",{params:p.value});_.value=u.data}catch(u){console.error("Failed to load inventory report:",u)}finally{U.value=!1}},M=async()=>{F.value=!0;try{const u=await w.get("/api/reports/profitability",{params:V.value});g.value=u.data}catch(u){console.error("Failed to load profitability report:",u)}finally{F.value=!1}},W=()=>{const u=new URLSearchParams(c.value).toString();window.open(`/api/reports/sales/pdf?${u}`,"_blank")},j=()=>{const u=new URLSearchParams(p.value).toString();window.open(`/api/reports/inventory/pdf?${u}`,"_blank")};return E(async()=>{const u=await w.get("/api/stores");y.value=u.data.data||u.data;const l=await w.get("/api/categories");R.value=l.data.data||l.data}),(u,l)=>(b(),K("div",null,[t(k,null,{default:e(()=>[t(o,{cols:"12"},{default:e(()=>[...l[15]||(l[15]=[s("h1",{class:"text-h4 mb-4"},"Reports",-1)])]),_:1})]),_:1}),t(Q,{modelValue:C.value,"onUpdate:modelValue":l[0]||(l[0]=a=>C.value=a),color:"primary"},{default:e(()=>[t(I,{value:"sales"},{default:e(()=>[...l[16]||(l[16]=[r("Sales Report",-1)])]),_:1}),t(I,{value:"inventory"},{default:e(()=>[...l[17]||(l[17]=[r("Inventory Report",-1)])]),_:1}),t(I,{value:"profitability"},{default:e(()=>[...l[18]||(l[18]=[r("Profitability Report",-1)])]),_:1})]),_:1},8,["modelValue"]),t(Y,{modelValue:C.value,"onUpdate:modelValue":l[14]||(l[14]=a=>C.value=a),class:"mt-4"},{default:e(()=>[t(G,{value:"sales"},{default:e(()=>[t(n,null,{default:e(()=>[t(i,null,{default:e(()=>[t(k,null,{default:e(()=>[t(o,{cols:"12",md:"3"},{default:e(()=>[t(T,{modelValue:c.value.date_from,"onUpdate:modelValue":l[1]||(l[1]=a=>c.value.date_from=a),label:"From Date",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(T,{modelValue:c.value.date_to,"onUpdate:modelValue":l[2]||(l[2]=a=>c.value.date_to=a),label:"To Date",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(N,{modelValue:c.value.store_id,"onUpdate:modelValue":l[3]||(l[3]=a=>c.value.store_id=a),items:y.value,"item-title":"name","item-value":"id",label:"Store",variant:"outlined",density:"compact",clearable:"",onCreated:l[4]||(l[4]=a=>y.value.push(a))},null,8,["modelValue","items"])]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(D,{color:"primary",onClick:A,loading:P.value},{default:e(()=>[...l[19]||(l[19]=[r(" Generate Report ",-1)])]),_:1},8,["loading"]),t(D,{color:"success",onClick:W,class:"ml-2",disabled:!f.value},{default:e(()=>[t(O,{left:""},{default:e(()=>[...l[20]||(l[20]=[r("mdi-file-pdf-box",-1)])]),_:1}),l[21]||(l[21]=r(" PDF ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1}),f.value?(b(),x(k,{key:0,class:"mt-4"},{default:e(()=>[t(o,{cols:"12",md:"3"},{default:e(()=>[t(n,{color:"primary",dark:""},{default:e(()=>[t(i,null,{default:e(()=>[l[22]||(l[22]=s("div",{class:"text-caption"},"Total Sales",-1)),s("div",h,d(f.value.summary.total_sales),1)]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(n,{color:"success",dark:""},{default:e(()=>[t(i,null,{default:e(()=>[l[23]||(l[23]=s("div",{class:"text-caption"},"Total Amount",-1)),s("div",tt,"₦"+d(v(f.value.summary.total_amount)),1)]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(n,{color:"info",dark:""},{default:e(()=>[t(i,null,{default:e(()=>[l[24]||(l[24]=s("div",{class:"text-caption"},"Gross Profit",-1)),s("div",et,"₦"+d(v(f.value.summary.gross_profit)),1)]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(n,{color:"warning",dark:""},{default:e(()=>[t(i,null,{default:e(()=>[l[25]||(l[25]=s("div",{class:"text-caption"},"Total Discount",-1)),s("div",lt,"₦"+d(v(f.value.summary.total_discount)),1)]),_:1})]),_:1})]),_:1})]),_:1})):S("",!0),f.value?(b(),x(B,{key:1,headers:L,items:f.value.sales,class:"mt-4"},{"item.total_amount":e(({item:a})=>[r(" ₦"+d(v(a.total_amount)),1)]),"item.discount_amount":e(({item:a})=>[r(" ₦"+d(v(a.discount_amount)),1)]),_:1},8,["items"])):S("",!0)]),_:1})]),_:1})]),_:1}),t(G,{value:"inventory"},{default:e(()=>[t(n,null,{default:e(()=>[t(i,null,{default:e(()=>[t(k,null,{default:e(()=>[t(o,{cols:"12",md:"4"},{default:e(()=>[t(N,{modelValue:p.value.store_id,"onUpdate:modelValue":l[5]||(l[5]=a=>p.value.store_id=a),items:y.value,"item-title":"name","item-value":"id",label:"Store *",variant:"outlined",density:"compact",onCreated:l[6]||(l[6]=a=>y.value.push(a))},null,8,["modelValue","items"])]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(Z,{modelValue:p.value.category_id,"onUpdate:modelValue":l[7]||(l[7]=a=>p.value.category_id=a),items:R.value,"item-title":"name","item-value":"id",label:"Category",variant:"outlined",density:"compact",clearable:"",onCreated:l[8]||(l[8]=a=>R.value.push(a))},null,8,["modelValue","items"])]),_:1}),t(o,{cols:"12",md:"2"},{default:e(()=>[t(J,{modelValue:p.value.low_stock_only,"onUpdate:modelValue":l[9]||(l[9]=a=>p.value.low_stock_only=a),label:"Low Stock Only",color:"primary"},null,8,["modelValue"])]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(D,{color:"primary",onClick:H,loading:U.value},{default:e(()=>[...l[26]||(l[26]=[r(" Generate Report ",-1)])]),_:1},8,["loading"]),t(D,{color:"success",onClick:j,class:"ml-2",disabled:!_.value},{default:e(()=>[t(O,{left:""},{default:e(()=>[...l[27]||(l[27]=[r("mdi-file-pdf-box",-1)])]),_:1}),l[28]||(l[28]=r(" PDF ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1}),_.value?(b(),x(k,{key:0,class:"mt-4"},{default:e(()=>[t(o,{cols:"12",md:"4"},{default:e(()=>[t(n,{color:"primary",dark:""},{default:e(()=>[t(i,null,{default:e(()=>[l[29]||(l[29]=s("div",{class:"text-caption"},"Total Products",-1)),s("div",at,d(_.value.summary.total_products),1)]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",md:"4"},{default:e(()=>[t(n,{color:"success",dark:""},{default:e(()=>[t(i,null,{default:e(()=>[l[30]||(l[30]=s("div",{class:"text-caption"},"Total Stock Value",-1)),s("div",ot,"₦"+d(v(_.value.summary.total_stock_value)),1)]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",md:"4"},{default:e(()=>[t(n,{color:"warning",dark:""},{default:e(()=>[t(i,null,{default:e(()=>[l[31]||(l[31]=s("div",{class:"text-caption"},"Low Stock Items",-1)),s("div",st,d(_.value.summary.low_stock_items),1)]),_:1})]),_:1})]),_:1})]),_:1})):S("",!0),_.value?(b(),x(B,{key:1,headers:q,items:_.value.inventory,class:"mt-4"},{"item.stock_value":e(({item:a})=>[r(" ₦"+d(v(a.stock_value)),1)]),"item.status":e(({item:a})=>[t(X,{color:a.is_low_stock?"warning":"success",size:"small"},{default:e(()=>[r(d(a.status),1)]),_:2},1032,["color"])]),_:1},8,["items"])):S("",!0)]),_:1})]),_:1})]),_:1}),t(G,{value:"profitability"},{default:e(()=>[t(n,null,{default:e(()=>[t(i,null,{default:e(()=>[t(k,null,{default:e(()=>[t(o,{cols:"12",md:"3"},{default:e(()=>[t(T,{modelValue:V.value.date_from,"onUpdate:modelValue":l[10]||(l[10]=a=>V.value.date_from=a),label:"From Date",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(T,{modelValue:V.value.date_to,"onUpdate:modelValue":l[11]||(l[11]=a=>V.value.date_to=a),label:"To Date",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(N,{modelValue:V.value.store_id,"onUpdate:modelValue":l[12]||(l[12]=a=>V.value.store_id=a),items:y.value,"item-title":"name","item-value":"id",label:"Store",variant:"outlined",density:"compact",clearable:"",onCreated:l[13]||(l[13]=a=>y.value.push(a))},null,8,["modelValue","items"])]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(D,{color:"primary",onClick:M,loading:F.value},{default:e(()=>[...l[32]||(l[32]=[r(" Generate Report ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1}),g.value?(b(),x(k,{key:0,class:"mt-4"},{default:e(()=>[t(o,{cols:"12",md:"3"},{default:e(()=>[t(n,{color:"primary",dark:""},{default:e(()=>[t(i,null,{default:e(()=>[l[33]||(l[33]=s("div",{class:"text-caption"},"Total Revenue",-1)),s("div",ut,"₦"+d(v(g.value.summary.total_revenue)),1)]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(n,{color:"error",dark:""},{default:e(()=>[t(i,null,{default:e(()=>[l[34]||(l[34]=s("div",{class:"text-caption"},"Total COGS",-1)),s("div",dt,"₦"+d(v(g.value.summary.total_cogs)),1)]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(n,{color:"success",dark:""},{default:e(()=>[t(i,null,{default:e(()=>[l[35]||(l[35]=s("div",{class:"text-caption"},"Gross Profit",-1)),s("div",rt,"₦"+d(v(g.value.summary.gross_profit)),1)]),_:1})]),_:1})]),_:1}),t(o,{cols:"12",md:"3"},{default:e(()=>[t(n,{color:"info",dark:""},{default:e(()=>[t(i,null,{default:e(()=>[l[36]||(l[36]=s("div",{class:"text-caption"},"Gross Margin",-1)),s("div",nt,d(g.value.summary.gross_margin_percentage)+"%",1)]),_:1})]),_:1})]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{Vt as default};
