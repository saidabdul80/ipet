import{b as J,ac as K,r,o as O,e as Q,f,h as l,w as a,V as v,i,q as A,m as p,g,j as k,E as D,n as m,p as s,G as C,ad as X,P as T,t as u,s as N,W as $,v as E,k as Y,af as Z,ae as ee,a9 as z,T as I,aa as q,a2 as w}from"./app-CJq9zEpr.js";const le={class:"font-weight-bold"},ae={class:"text-caption text-grey"},se={__name:"BranchList",setup(te){const B=J(),{alert:U,confirm:R}=K(),h=r(!1),x=r(!1),c=r(!1),V=r(!1),y=r(!1),_=r(""),S=r([]),d=r(null),M=[{title:"Branch",key:"name"},{title:"Address",key:"address"},{title:"Phone",key:"phone"},{title:"Status",key:"is_active"},{title:"Actions",key:"actions",sortable:!1}],o=r({name:"",code:"",address:"",phone:"",email:"",is_active:!0}),b=async()=>{h.value=!0;try{const n={search:_.value},e=await w.get("/api/branches",{params:n});S.value=e.data.data||e.data}catch(n){console.error("Failed to load branches:",n)}finally{h.value=!1}},j=()=>{y.value=!1,o.value={name:"",code:"",address:"",phone:"",email:"",is_active:!0},c.value=!0},G=n=>{y.value=!0,o.value={...n},c.value=!0},F=()=>{c.value=!1},L=async()=>{x.value=!0;try{y.value?await w.put(`/api/branches/${o.value.id}`,o.value):await w.post("/api/branches",o.value),F(),b()}catch(n){console.error("Failed to save branch:",n),U("Failed to save branch")}finally{x.value=!1}},W=n=>{d.value=n,V.value=!0},H=async n=>{if(await R(`Are you sure you want to delete ${n.name}?`))try{await w.delete(`/api/branches/${n.id}`),b()}catch(t){console.error("Failed to delete branch:",t),U("Failed to delete branch")}};return O(()=>{b()}),(n,e)=>(f(),Q("div",null,[l(A,null,{default:a(()=>[l(v,{cols:"12"},{default:a(()=>[...e[10]||(e[10]=[i("h1",{class:"text-h4 mb-4"},"Branches",-1)])]),_:1})]),_:1}),l(A,null,{default:a(()=>[l(v,{cols:"12",md:"8"},{default:a(()=>[l(p,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),label:"Search branches...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",onInput:b},null,8,["modelValue"])]),_:1}),l(v,{cols:"12",md:"4",class:"text-right"},{default:a(()=>[D(B).hasPermission("create_branches")?(f(),g(m,{key:0,color:"primary",onClick:j},{default:a(()=>[l(C,{left:""},{default:a(()=>[...e[11]||(e[11]=[s("mdi-plus",-1)])]),_:1}),e[12]||(e[12]=s(" Add Branch ",-1))]),_:1})):k("",!0)]),_:1})]),_:1}),l(N,null,{default:a(()=>[l(X,{headers:M,items:S.value,loading:h.value},{"item.name":a(({item:t})=>[i("div",null,[i("div",le,u(t.name),1),i("div",ae,u(t.code),1)])]),"item.is_active":a(({item:t})=>[l(T,{color:t.is_active?"success":"error",size:"small"},{default:a(()=>[s(u(t.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),"item.actions":a(({item:t})=>[l(m,{icon:"",size:"small",onClick:P=>W(t),title:"View"},{default:a(()=>[l(C,null,{default:a(()=>[...e[13]||(e[13]=[s("mdi-eye",-1)])]),_:1})]),_:1},8,["onClick"]),D(B).hasPermission("update_branches")?(f(),g(m,{key:0,icon:"",size:"small",onClick:P=>G(t),title:"Edit"},{default:a(()=>[l(C,null,{default:a(()=>[...e[14]||(e[14]=[s("mdi-pencil",-1)])]),_:1})]),_:1},8,["onClick"])):k("",!0),D(B).hasPermission("delete_branches")?(f(),g(m,{key:1,icon:"",size:"small",onClick:P=>H(t),title:"Delete",color:"error"},{default:a(()=>[l(C,null,{default:a(()=>[...e[15]||(e[15]=[s("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])):k("",!0)]),_:1},8,["items","loading"])]),_:1}),l(q,{modelValue:c.value,"onUpdate:modelValue":e[7]||(e[7]=t=>c.value=t),"max-width":"600px",persistent:""},{default:a(()=>[l(N,null,{default:a(()=>[l($,null,{default:a(()=>[s(u(y.value?"Edit Branch":"New Branch"),1)]),_:1}),l(E,null,{default:a(()=>[l(Y,{ref:"form"},{default:a(()=>[l(p,{modelValue:o.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.name=t),label:"Branch Name *",variant:"outlined",rules:[t=>!!t||"Required"]},null,8,["modelValue","rules"]),l(p,{modelValue:o.value.code,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.code=t),label:"Branch Code *",variant:"outlined",rules:[t=>!!t||"Required"]},null,8,["modelValue","rules"]),l(Z,{modelValue:o.value.address,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.address=t),label:"Address",variant:"outlined",rows:"2"},null,8,["modelValue"]),l(p,{modelValue:o.value.phone,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.phone=t),label:"Phone",variant:"outlined"},null,8,["modelValue"]),l(p,{modelValue:o.value.email,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.email=t),label:"Email",type:"email",variant:"outlined"},null,8,["modelValue"]),l(ee,{modelValue:o.value.is_active,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.is_active=t),label:"Active",color:"primary"},null,8,["modelValue"])]),_:1},512)]),_:1}),l(z,null,{default:a(()=>[l(I),l(m,{onClick:F},{default:a(()=>[...e[16]||(e[16]=[s("Cancel",-1)])]),_:1}),l(m,{color:"primary",onClick:L,loading:x.value},{default:a(()=>[...e[17]||(e[17]=[s("Save",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(q,{modelValue:V.value,"onUpdate:modelValue":e[9]||(e[9]=t=>V.value=t),"max-width":"600px"},{default:a(()=>[d.value?(f(),g(N,{key:0},{default:a(()=>[l($,{class:"bg-primary text-white"},{default:a(()=>[s(u(d.value.name)+" ",1),l(T,{color:d.value.is_active?"success":"error",class:"ml-2"},{default:a(()=>[s(u(d.value.is_active?"Active":"Inactive"),1)]),_:1},8,["color"])]),_:1}),l(E,{class:"mt-4"},{default:a(()=>[l(A,null,{default:a(()=>[l(v,{cols:"12"},{default:a(()=>[e[18]||(e[18]=i("strong",null,"Code:",-1)),s(" "+u(d.value.code),1)]),_:1}),l(v,{cols:"12"},{default:a(()=>[e[19]||(e[19]=i("strong",null,"Address:",-1)),s(" "+u(d.value.address||"N/A"),1)]),_:1}),l(v,{cols:"6"},{default:a(()=>[e[20]||(e[20]=i("strong",null,"Phone:",-1)),s(" "+u(d.value.phone||"N/A"),1)]),_:1}),l(v,{cols:"6"},{default:a(()=>[e[21]||(e[21]=i("strong",null,"Email:",-1)),s(" "+u(d.value.email||"N/A"),1)]),_:1})]),_:1})]),_:1}),l(z,null,{default:a(()=>[l(I),l(m,{onClick:e[8]||(e[8]=t=>V.value=!1)},{default:a(()=>[...e[22]||(e[22]=[s("Close",-1)])]),_:1})]),_:1})]),_:1})):k("",!0)]),_:1},8,["modelValue"])]))}};export{se as default};
