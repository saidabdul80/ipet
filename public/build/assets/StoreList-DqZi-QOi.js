import{b as Q,ac as X,r as n,o as Y,a2 as p,e as Z,f as y,h as a,w as t,V as i,i as m,q as N,m as k,a4 as R,g as C,j as S,E as F,n as v,p as s,G as w,ad as ee,P as q,t as d,s as P,W as z,v as E,k as le,af as ae,ae as te,a9 as I,T as M,aa as W}from"./app-BU2Ar5cD.js";const oe={class:"font-weight-bold"},se={class:"text-caption text-grey"},de={__name:"StoreList",setup(ue){const _=Q(),{alert:T,confirm:j}=X(),x=n(!1),A=n(!1),f=n(!1),b=n(!1),g=n(!1),B=n(""),U=n(null),$=n([]),D=n([]),r=n(null),G=[{title:"Store",key:"name"},{title:"Branch",key:"branch"},{title:"Address",key:"address"},{title:"Phone",key:"phone"},{title:"Status",key:"is_active"},{title:"Actions",key:"actions",sortable:!1}],o=n({branch_id:null,name:"",code:"",address:"",phone:"",is_active:!0}),c=async()=>{x.value=!0;try{const u={search:B.value,branch_id:U.value},e=await p.get("/api/stores",{params:u});$.value=e.data.data||e.data}catch(u){console.error("Failed to load stores:",u)}finally{x.value=!1}},L=()=>{g.value=!1,o.value={branch_id:null,name:"",code:"",address:"",phone:"",is_active:!0},f.value=!0},H=u=>{g.value=!0,o.value={...u},f.value=!0},h=()=>{f.value=!1},J=async()=>{A.value=!0;try{g.value?await p.put(`/api/stores/${o.value.id}`,o.value):await p.post("/api/stores",o.value),h(),c()}catch(u){console.error("Failed to save store:",u),T("Failed to save store")}finally{A.value=!1}},K=u=>{r.value=u,b.value=!0},O=async u=>{if(await j(`Are you sure you want to delete ${u.name}?`))try{await p.delete(`/api/stores/${u.id}`),c()}catch(l){console.error("Failed to delete store:",l),T("Failed to delete store")}};return Y(async()=>{const u=await p.get("/api/branches");D.value=u.data.data||u.data,c()}),(u,e)=>(y(),Z("div",null,[a(N,null,{default:t(()=>[a(i,{cols:"12"},{default:t(()=>[...e[11]||(e[11]=[m("h1",{class:"text-h4 mb-4"},"Stores / Warehouses",-1)])]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(i,{cols:"12",md:"4"},{default:t(()=>[a(k,{modelValue:B.value,"onUpdate:modelValue":e[0]||(e[0]=l=>B.value=l),label:"Search stores...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",onInput:c},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"4"},{default:t(()=>[a(R,{modelValue:U.value,"onUpdate:modelValue":[e[1]||(e[1]=l=>U.value=l),c],items:D.value,"item-title":"name","item-value":"id",label:"Branch",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items"])]),_:1}),a(i,{cols:"12",md:"4",class:"text-right"},{default:t(()=>[F(_).hasPermission("create_stores")?(y(),C(v,{key:0,color:"primary",onClick:L},{default:t(()=>[a(w,{left:""},{default:t(()=>[...e[12]||(e[12]=[s("mdi-plus",-1)])]),_:1}),e[13]||(e[13]=s(" Add Store ",-1))]),_:1})):S("",!0)]),_:1})]),_:1}),a(P,null,{default:t(()=>[a(ee,{headers:G,items:$.value,loading:x.value},{"item.name":t(({item:l})=>[m("div",null,[m("div",oe,d(l.name),1),m("div",se,d(l.code),1)])]),"item.branch":t(({item:l})=>{var V;return[s(d((V=l.branch)==null?void 0:V.name),1)]}),"item.is_active":t(({item:l})=>[a(q,{color:l.is_active?"success":"error",size:"small"},{default:t(()=>[s(d(l.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),"item.actions":t(({item:l})=>[a(v,{icon:"",size:"small",onClick:V=>K(l),title:"View"},{default:t(()=>[a(w,null,{default:t(()=>[...e[14]||(e[14]=[s("mdi-eye",-1)])]),_:1})]),_:1},8,["onClick"]),F(_).hasPermission("update_stores")?(y(),C(v,{key:0,icon:"",size:"small",onClick:V=>H(l),title:"Edit"},{default:t(()=>[a(w,null,{default:t(()=>[...e[15]||(e[15]=[s("mdi-pencil",-1)])]),_:1})]),_:1},8,["onClick"])):S("",!0),F(_).hasPermission("delete_stores")?(y(),C(v,{key:1,icon:"",size:"small",onClick:V=>O(l),title:"Delete",color:"error"},{default:t(()=>[a(w,null,{default:t(()=>[...e[16]||(e[16]=[s("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])):S("",!0)]),_:1},8,["items","loading"])]),_:1}),a(W,{modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=l=>f.value=l),"max-width":"600px",persistent:""},{default:t(()=>[a(P,null,{default:t(()=>[a(z,null,{default:t(()=>[s(d(g.value?"Edit Store":"New Store"),1)]),_:1}),a(E,null,{default:t(()=>[a(le,{ref:"form"},{default:t(()=>[a(R,{modelValue:o.value.branch_id,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.branch_id=l),items:D.value,"item-title":"name","item-value":"id",label:"Branch *",variant:"outlined",rules:[l=>!!l||"Required"]},null,8,["modelValue","items","rules"]),a(k,{modelValue:o.value.name,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.name=l),label:"Store Name *",variant:"outlined",rules:[l=>!!l||"Required"]},null,8,["modelValue","rules"]),a(k,{modelValue:o.value.code,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.code=l),label:"Store Code *",variant:"outlined",rules:[l=>!!l||"Required"]},null,8,["modelValue","rules"]),a(ae,{modelValue:o.value.address,"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.address=l),label:"Address",variant:"outlined",rows:"2"},null,8,["modelValue"]),a(k,{modelValue:o.value.phone,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.phone=l),label:"Phone",variant:"outlined"},null,8,["modelValue"]),a(te,{modelValue:o.value.is_active,"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.is_active=l),label:"Active",color:"primary"},null,8,["modelValue"])]),_:1},512)]),_:1}),a(I,null,{default:t(()=>[a(M),a(v,{onClick:h},{default:t(()=>[...e[17]||(e[17]=[s("Cancel",-1)])]),_:1}),a(v,{color:"primary",onClick:J,loading:A.value},{default:t(()=>[...e[18]||(e[18]=[s("Save",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(W,{modelValue:b.value,"onUpdate:modelValue":e[10]||(e[10]=l=>b.value=l),"max-width":"600px"},{default:t(()=>[r.value?(y(),C(P,{key:0},{default:t(()=>[a(z,{class:"bg-primary text-white"},{default:t(()=>[s(d(r.value.name)+" ",1),a(q,{color:r.value.is_active?"success":"error",class:"ml-2"},{default:t(()=>[s(d(r.value.is_active?"Active":"Inactive"),1)]),_:1},8,["color"])]),_:1}),a(E,{class:"mt-4"},{default:t(()=>[a(N,null,{default:t(()=>[a(i,{cols:"12"},{default:t(()=>[e[19]||(e[19]=m("strong",null,"Code:",-1)),s(" "+d(r.value.code),1)]),_:1}),a(i,{cols:"12"},{default:t(()=>{var l;return[e[20]||(e[20]=m("strong",null,"Branch:",-1)),s(" "+d((l=r.value.branch)==null?void 0:l.name),1)]}),_:1}),a(i,{cols:"12"},{default:t(()=>[e[21]||(e[21]=m("strong",null,"Address:",-1)),s(" "+d(r.value.address||"N/A"),1)]),_:1}),a(i,{cols:"12"},{default:t(()=>[e[22]||(e[22]=m("strong",null,"Phone:",-1)),s(" "+d(r.value.phone||"N/A"),1)]),_:1})]),_:1})]),_:1}),a(I,null,{default:t(()=>[a(M),a(v,{onClick:e[9]||(e[9]=l=>b.value=!1)},{default:t(()=>[...e[23]||(e[23]=[s("Close",-1)])]),_:1})]),_:1})]),_:1})):S("",!0)]),_:1},8,["modelValue"])]))}};export{de as default};
