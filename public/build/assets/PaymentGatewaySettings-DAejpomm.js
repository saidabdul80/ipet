import{r as u,ac as K,o as M,g as V,f as p,w as t,i,h as l,n as m,p as n,q,e as U,J as z,K as J,V as c,s as A,N as L,W as E,j as C,G as k,t as d,P,v as $,a9 as F,aa as R,k as W,m as w,a4 as H,af as O,T as Q,x as X,a2 as v}from"./app-CJq9zEpr.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"d-flex justify-space-between align-center mb-6"},h={class:"d-flex align-center"},ee={class:"text-body-2 mb-3"},ae={class:"mb-2"},le={class:"text-caption text-grey-darken-1"},te={class:"text-h5"},se={__name:"PaymentGatewaySettings",setup(re){const D=u([]),f=u(!1),y=u(!1),G=u(!1),g=u(!1),{alert:x}=K(),b=u(null),r=u({display_name:"",driver:"paystack",description:"",credentials:{public_key:"",secret_key:""},currency:"NGN",supported_channels:[],is_active:!0,is_default:!1,priority:0}),_=async()=>{try{const s=await v.get("/api/payment-gateways");D.value=s.data}catch(s){console.error("Error fetching gateways:",s)}},N=(s=null)=>{y.value=!!s,s?r.value={id:s.id,display_name:s.display_name,driver:s.driver,description:s.description,credentials:s.credentials||{public_key:"",secret_key:""},currency:s.currency,supported_channels:s.supported_channels||[],is_active:s.is_active,is_default:s.is_default,priority:s.priority}:r.value={display_name:"",driver:"paystack",description:"",credentials:{public_key:"",secret_key:""},currency:"NGN",supported_channels:["card","bank","ussd"],is_active:!0,is_default:!1,priority:0},f.value=!0},S=()=>{var s;f.value=!1,(s=b.value)==null||s.reset()},T=async()=>{var s,a,e;if((s=b.value)!=null&&s.validate()){g.value=!0;try{y.value?await v.put(`/api/payment-gateways/${r.value.id}`,r.value):await v.post("/api/payment-gateways",{...r.value,name:r.value.driver.charAt(0).toUpperCase()+r.value.driver.slice(1)}),await _(),S()}catch(o){console.error("Error saving gateway:",o),x(((e=(a=o.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to save gateway")}finally{g.value=!1}}},B=async s=>{var a,e;try{await v.post(`/api/payment-gateways/${s.id}/toggle`,{is_active:!s.is_active}),await _()}catch(o){console.error("Error toggling gateway:",o),x(((e=(a=o.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to toggle gateway")}},j=async s=>{var a,e;try{await v.post(`/api/payment-gateways/${s.id}/set-default`),await _()}catch(o){console.error("Error setting default gateway:",o),x(((e=(a=o.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to set default gateway")}},I=s=>({paystack:"mdi-credit-card",monnify:"mdi-bank",palmpay:"mdi-wallet"})[s]||"mdi-credit-card";return M(()=>{_()}),(s,a)=>(p(),V(X,{fluid:"",class:"pa-6"},{default:t(()=>[i("div",Z,[a[9]||(a[9]=i("div",null,[i("h1",{class:"text-h4 font-weight-bold mb-2"},"Payment Gateway Settings"),i("p",{class:"text-subtitle-1 text-grey-darken-1"},"Configure payment gateways for online wallet funding")],-1)),l(m,{color:"primary","prepend-icon":"mdi-plus",onClick:a[0]||(a[0]=e=>N()),size:"large"},{default:t(()=>[...a[8]||(a[8]=[n(" Add Gateway ",-1)])]),_:1})]),l(q,null,{default:t(()=>[(p(!0),U(z,null,J(D.value,e=>(p(),V(c,{key:e.id,cols:"12",md:"6",lg:"4"},{default:t(()=>[l(A,{class:L(["gateway-card",{"active-gateway":e.is_active,"default-gateway":e.is_default}]),elevation:"2"},{default:t(()=>[l(E,{class:"d-flex justify-space-between align-center"},{default:t(()=>[i("div",h,[l(k,{color:e.is_active?"success":"grey",class:"mr-2"},{default:t(()=>[n(d(I(e.driver)),1)]),_:2},1032,["color"]),i("span",null,d(e.display_name),1)]),e.is_default?(p(),V(P,{key:0,color:"primary",size:"small",variant:"flat"},{default:t(()=>[...a[10]||(a[10]=[n(" Default ",-1)])]),_:1})):C("",!0)]),_:2},1024),l($,null,{default:t(()=>{var o;return[i("p",ee,d(e.description),1),i("div",ae,[l(P,{color:e.is_active?"success":"error",size:"small",variant:"tonal"},{default:t(()=>[n(d(e.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),i("div",le,[i("div",null,[a[11]||(a[11]=i("strong",null,"Currency:",-1)),n(" "+d(e.currency),1)]),i("div",null,[a[12]||(a[12]=i("strong",null,"Channels:",-1)),n(" "+d(((o=e.supported_channels)==null?void 0:o.join(", "))||"N/A"),1)])])]}),_:2},1024),l(F,null,{default:t(()=>[l(m,{size:"small",variant:"text",onClick:o=>N(e)},{default:t(()=>[l(k,{start:""},{default:t(()=>[...a[13]||(a[13]=[n("mdi-pencil",-1)])]),_:1}),a[14]||(a[14]=n(" Edit ",-1))]),_:1},8,["onClick"]),l(m,{size:"small",variant:"text",color:e.is_active?"error":"success",onClick:o=>B(e)},{default:t(()=>[l(k,{start:""},{default:t(()=>[n(d(e.is_active?"mdi-pause":"mdi-play"),1)]),_:2},1024),n(" "+d(e.is_active?"Deactivate":"Activate"),1)]),_:2},1032,["color","onClick"]),!e.is_default&&e.is_active?(p(),V(m,{key:0,size:"small",variant:"text",color:"primary",onClick:o=>j(e)},{default:t(()=>[l(k,{start:""},{default:t(()=>[...a[15]||(a[15]=[n("mdi-star",-1)])]),_:1}),a[16]||(a[16]=n(" Set Default ",-1))]),_:1},8,["onClick"])):C("",!0)]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1}),l(R,{modelValue:f.value,"onUpdate:modelValue":a[7]||(a[7]=e=>f.value=e),"max-width":"800px",persistent:""},{default:t(()=>[l(A,null,{default:t(()=>[l(E,{class:"bg-primary text-white"},{default:t(()=>[i("span",te,d(y.value?"Edit":"Add")+" Payment Gateway",1)]),_:1}),l($,{class:"pt-6"},{default:t(()=>[l(W,{ref_key:"form",ref:b,modelValue:G.value,"onUpdate:modelValue":a[6]||(a[6]=e=>G.value=e)},{default:t(()=>[l(q,null,{default:t(()=>[l(c,{cols:"12",md:"6"},{default:t(()=>[l(w,{modelValue:r.value.display_name,"onUpdate:modelValue":a[1]||(a[1]=e=>r.value.display_name=e),label:"Display Name",rules:[e=>!!e||"Display name is required"],required:""},null,8,["modelValue","rules"])]),_:1}),l(c,{cols:"12",md:"6"},{default:t(()=>[l(H,{modelValue:r.value.driver,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value.driver=e),items:["paystack","monnify","palmpay"],label:"Gateway Driver",rules:[e=>!!e||"Driver is required"],disabled:y.value,required:""},null,8,["modelValue","rules","disabled"])]),_:1}),l(c,{cols:"12"},{default:t(()=>[l(O,{modelValue:r.value.description,"onUpdate:modelValue":a[3]||(a[3]=e=>r.value.description=e),label:"Description",rows:"2"},null,8,["modelValue"])]),_:1}),l(c,{cols:"12"},{default:t(()=>[...a[17]||(a[17]=[i("h3",{class:"text-h6 mb-3"},"Credentials",-1)])]),_:1}),r.value.driver==="paystack"?(p(),U(z,{key:0},[l(c,{cols:"12",md:"6"},{default:t(()=>[l(w,{modelValue:r.value.credentials.public_key,"onUpdate:modelValue":a[4]||(a[4]=e=>r.value.credentials.public_key=e),label:"Public Key",rules:[e=>!!e||"Public key is required"],required:""},null,8,["modelValue","rules"])]),_:1}),l(c,{cols:"12",md:"6"},{default:t(()=>[l(w,{modelValue:r.value.credentials.secret_key,"onUpdate:modelValue":a[5]||(a[5]=e=>r.value.credentials.secret_key=e),label:"Secret Key",type:"password",rules:[e=>!!e||"Secret key is required"],required:""},null,8,["modelValue","rules"])]),_:1})],64)):C("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(F,null,{default:t(()=>[l(Q),l(m,{color:"grey",variant:"text",onClick:S},{default:t(()=>[...a[18]||(a[18]=[n("Cancel",-1)])]),_:1}),l(m,{color:"primary",variant:"flat",onClick:T,loading:g.value},{default:t(()=>[...a[19]||(a[19]=[n("Save",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},ne=Y(se,[["__scopeId","data-v-94fec9ee"]]);export{ne as default};
